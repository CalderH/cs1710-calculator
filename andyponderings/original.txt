#lang forge

option problem_type temporal
option max_tracelength 10

-----------------WORLD 1 (unedited from last brainstorming session)-----------------------

sig NumFrame {
	var value : some Int,
    var prev : lone NumFrame // Goes from top to bottom
}

-- Not "one sig" because we want to be able to model multiple stacks
-- if we want it to be one in the meantime we can just make it 'one' in the traces
sig NumStack {
	var top: lone NumFrame
}

abstract sig Operation {}
one sig Addition{} extends Operation
one sig END{} extends Operation //Points to itseelf as an end...

sig OperationFrame {
	operation : one Operation,
    next: one OperationFrame
    -- The last OperationFrame points to itself
}

sig PC {current: one OperationFrame}

----------------------------------------

pred andersons-add {
	PC.current.operation = Addition --at correct operation
    some top.prev --you have enough frames (a top and a previous of the top is enough)
    
    -- current stack
    all n : NumStack | {
    	one f : n.top.*prev | {
        in 
        set differnce
        
          	prev' = pop2[prev] + top.prev -> (add[top.value, top.prev.value] -> none)
    		top' = (add[top.value, top.prev.value] -> none)
        }
  	}
}